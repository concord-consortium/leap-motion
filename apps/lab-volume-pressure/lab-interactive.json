{
  "title": "The Volume-Pressure Relationship",
  "publicationStatus": "public",
  "subtitle": "Explore how the volume of a gas affects pressure.",
  "aspectRatio": 1.35,
  "about": [
    "Gases can be compressed into smaller volumes. How does compressing a gas affect its pressure?",
    "",
    "Run the model, then change the volume of the containers and observe the change in pressure.",
    "The moving wall converts the effect of molecular collisions into pressure and acts as a pressure gauge.",
    "What happens to the pressure when the volume changes?",
    "",
    "----",
    "*Note: Although the atoms in this model are in a flat plane, volume is calculated using 0.1 nm as the depth of the container.*"
  ],
  "models": [
    {
      "type": "md2d",
      "id": "page3$0",
      "viewOptions": {
        "controlButtons": "play_reset"
      }
    }
  ],
  "parameters": [
    {
      "name": "prevOrientation",
      "initialValue": "right"
    },
    {
      "name": "orientation",
      "initialValue": "right",
      "onChange": [
        "if (value === get('prevOrientation')) return;",
        "var width = get('width');",
        "batch(function() {",
        "  var num = getNumberOfAtoms();",
        "  for(var i = 0; i < num; i++) {",
        "    setAtomProperties(i, { x: width - getAtomProperties(i).x });",
        "  }",
        "});",
        "if (get('volume') !== undefined) set('volume', get('volume'));",
        "set('prevOrientation', value);"
      ]
    },
    {
      "name": "volume",
      "unitAbbreviation": "nm³",
      "label": "Volume",
      "initialValue": 0.82,
      "onChange": [
        "var width = get('width');",
        "var o = get('orientation');",
        "var newX = value / 0.1 / get('height');",
        "if (o === 'left') newX = width - newX;",
        "var obsX = o === 'left' ? newX - getObstacleProperties(0).width : newX;",
        "if (getObstacleProperties(0).x === obsX) return;",
        "setObstacleProperties(0, {x: obsX});",
        "setShapeProperties(0, o === 'left' ? {x: obsX, width: width} : {x: 0, width: obsX});",
        "var minX = Infinity;",
        "var maxX = 0;",
        "for(var i = 0; i < getNumberOfAtoms(); i++) {",
        "  var atomX = getAtomProperties(i).x;",
        "  if (atomX > maxX) maxX = atomX;",
        "  else if (atomX < minX) minX = atomX;",
        "}",
        "if (o === 'right' && newX - 0.1 > maxX) return;",
        "if (o === 'left' && newX + 0.1 < minX) return;",
        "var scaleFactor = o === 'left' ? (width - newX - 0.1) / (width - minX) : (newX - 0.1) / maxX;",
        "batch(function() {",
        "  var num = getNumberOfAtoms();",
        "  for(i = 0; i < num; i++) {",
        "    setAtomProperties(i, o === 'left' ? {x: width - (width - getAtomProperties(i).x) * scaleFactor } :",
        "                                        {x: getAtomProperties(i).x * scaleFactor});",
        "  }",
        "});",
        "if (scaleFactor < 1) {",
        "  minimizeEnergy();",
        "}"
      ]
    },
    {
      "name": "plungerHighlighted",
      "initialValue": false,
      "onChange": [
        "setObstacleProperties(0, {color: value ? '#E8DC36' : '#888'});",
        "setComponentDisabled('plunger-right', value);",
        "setComponentDisabled('plunger-left', value);"
      ]
    },
    {
      "name": "atomsHighlighted",
      "initialValue": false,
      "onChange": [
        "setElementProperties(3, {color: value ? -13134236 : -3355444});"
      ]
    }
  ],
  "outputs": [
    {
      "name": "pressureProbeInstantaneous",
      "unitType": "pressure",
      "label": "Pressure Gauge",
      "value": [
        "return get('orientation') === 'right' ? getObstacleProperties(0).westProbeValue : getObstacleProperties(0).eastProbeValue;"
      ]
    }
  ],
  "filteredOutputs": [
    {
      "name": "pressureProbeFiltered",
      "unitType": "pressure",
      "label": "Pressure Gauge",
      "property": "pressureProbeInstantaneous",
      "type": "RunningAverage",
      "period": 2500
    }
  ],
  "components": [
    {
      "type": "barGraph",
      "id": "bar-graph",
      "min": 0,
      "max": 2.5,
      "title": "Pressure (Bar)",
      "property": "pressureProbeFiltered"
    },
    {
      "id": "plunger-left",
      "type": "button",
      "action": [
        "if (get('orientation') === 'left') {",
        "  if (get('volume') < 0.77) { set({ volume: get('volume') + 0.05 }) };",
        "} else {",
        "  if (get('volume') > 0.14) { set({ volume: get('volume') - 0.05 }) };",
        "}"
      ],
      "text": "⟵"
    },
    {
      "id": "plunger-right",
      "type": "button",
      "action": [
        "if (get('orientation') === 'left') {",
        "  if (get('volume') > 0.14) { set({ volume: get('volume') - 0.05 }) };",
        "} else {",
        "  if (get('volume') < 0.77) { set({ volume: get('volume') + 0.05 }) };",
        "}"
    ],
      "text": "⟶"
    }
  ],
  "layout": {
    "right": [
      "bar-graph"
    ]
  },
  "template": "narrow-right"
}
